(function($){$(document).foundation();$("#masthead:not(.distraction-free").headroom();$(document).ready(function(){const $giftMessage=document.getElementById("gift_message");if($giftMessage!=null){var maxLength=$giftMessage.dataset.maxLength;if(maxLength==null){maxLength=30}
$giftMessage.maxLength=maxLength;$giftMessage.addEventListener("keypress",(ev)=>{var textLength=maxLength-$giftMessage.value.length})}
$(".prints-filters select").on("change",function(){$(location).attr("href",this.value)});$(".mlightbox").magnificPopup({type:"image"});$(".products").on("click",".frame-chooser li",function(e){var color=$(this).data("color");var frame=$(this).closest(".product").find(".image-wrapper."+color);if(frame.length){e.preventDefault();$(this).closest(".product").find(".image-wrapper").hide();frame.show()}});$(".carousel").flickity({prevNextButtons:!1,});$(".slide-nav").flickity({asNavFor:".carousel",contain:!0,pageDots:!1,});$(".benefits-toggle").click(function(){$(".woocommerce-product-details__short-description").slideToggle()});$(".payment-options .top-wrapper").click(function(){$(this).next(".drawer").slideToggle()});$(".covers").infiniteScroll({path:"product-category/30-years-of-tsj/page/{{#}}",append:".product",history:!1,status:".page-load-status",});$(document.body).on("added_to_cart",function(event,fragments,cart_hash){$("#journal-cart").foundation("open",event)});var $jc_fragment_refresh={url:wc_cart_fragments_params.wc_ajax_url.toString().replace("%%endpoint%%","get_refreshed_fragments"),type:"POST",data:{time:new Date().getTime(),},timeout:wc_cart_fragments_params.request_timeout,success:function(data){if(data&&data.fragments){$.each(data.fragments,function(key,value){$(key).replaceWith(value)});$(document.body).trigger("wc_fragments_refreshed")}},error:function(){$(document.body).trigger("wc_fragments_ajax_error")},};$(".product-type-variable:not(.direct-checkout) .entry-summary form.cart, .product-type-simple:not(.direct-checkout) .entry-summary form.cart").on("submit",function(e){e.preventDefault();var add_to_cart_button=$(".single_add_to_cart_button");add_to_cart_button.addClass("loading");add_to_cart_button.block({message:null,overlayCSS:{cursor:"none",},});var form=$(this),button=add_to_cart_button,request=form.serialize()+"&"+encodeURI(button.attr("name"))+"="+encodeURI(button.attr("value"));$.ajax({url:form.attr("action"),data:request+"&_wp_http_referer="+form.attr("action"),}).done(function(result){var cart_dropdown=$(".widget_shopping_cart",result);$(".widget_shopping_cart").replaceWith(cart_dropdown);$.ajax($jc_fragment_refresh);add_to_cart_button.unblock();add_to_cart_button.removeClass("loading");$("#journal-cart").trigger("cart:opened");$("#journal-cart").foundation("open",event)})});$(".upgrade_downgrade").click(function(){let link=$(this).attr("href");confirm(function(){window.location.href=link});return!1});function confirm(callback){var modal='<div class="reveal journal-modal" id="upgrade-confirmation">'+'<div class="wrapper">'+"<h2>You are about to upgrade your subscription</h2>"+'<p>Any remaining copies in your current subscription will be transferred to your new Premium Subscription. For more information please see our <a href="/faqs">FAQ</a>.</p>'+'<button class="button yes">Proceed</button> '+'<button class="close-button" data-close aria-label="Close modal" type="button">'+'<span aria-hidden="true">&times;</span>'+"</button>"+"</div>";$("body").append(modal);var confirmation=new Foundation.Reveal($("#upgrade-confirmation"));confirmation.open();$("#upgrade-confirmation").find(".yes").on("click",function(){confirmation.close();$("#upgrade-confirmation").remove();callback.call()});$(document).on("closed.zf.reveal","#upgrade-confirmation",function(){$("#upgrade-confirmation").remove()})}
$("form.woocommerce-checkout input").not("#place_order").keypress(function(e){if(e.which===13){return!1}});$(document).on("blur",".jc-input-wrapper input",function(){let input=$(this);if(input.val()){input.closest(".jc-input-wrapper").addClass("is-active")}else{input.closest(".jc-input-wrapper").removeClass("is-active")}});$(document).on("focus",".jc-input-wrapper input",function(){let input=$(this);input.closest(".jc-input-wrapper").addClass("is-active")});$(document).on("input",".jc-input-wrapper input",function(){let input=$(this);input.closest(".jc-input-wrapper").addClass("is-active")});$(".form-row input").on("blur",function(){let input=$(this);if(input.val()){input.closest(".form-row").addClass("is-active")}else{input.closest(".form-row").removeClass("is-active")}});$(".form-row input").on("focus",function(){let input=$(this);input.closest(".form-row").addClass("is-active")});$(".form-row input").on("input",function(){let input=$(this);input.closest(".form-row").addClass("is-active")});$(".form-row input").each(function(){let input=$(this);if(input.val()){input.closest(".form-row").addClass("is-active")}});$(".jc-input-wrapper input").each(function(){let input=$(this);if(input.val()){input.closest(".jc-input-wrapper").addClass("is-active")}});$('.form-row input[name="shipping_address_1"], .form-row input[name="billing_address_1"]').on("change",function(){setTimeout(()=>{$(".form-row input").each(function(){let input=$(this);if(input.val()){input.closest(".form-row").addClass("is-active")}})},1000)})});$(document.body).on("post-load",function(){if("undefined"!==typeof affirm){affirm.ui.refresh()}})})(jQuery)